<!-- Breadcrumb -->
<nav class="container pt-4 mt-lg-3" aria-label="breadcrumb">
<ol class="breadcrumb mb-0">
    <li class="breadcrumb-item">
    <a href="index.html"><i class="bx bx-home-alt fs-lg me-1"></i>Home</a>
    </li>
    <li class="breadcrumb-item">
    <a href="blog-list-with-sidebar.html">Blog</a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Single Post</li>
</ol> 
</nav>


<!-- Post title + Meta  -->
<section class="container mt-4 pt-lg-2 pb-3">
    <h1 class="pb-3" style="max-width: 970px;"><%= @post.title %> 、探してます</h1>
    <div class="d-flex flex-md-row flex-column align-items-md-center justify-content-md-between mb-3">
        <div class="d-flex align-items-center flex-wrap text-muted mb-md-0 mb-4">
            <div class="fs-xs border-end pe-3 me-3 mb-2">
                <span class="badge bg-faded-primary text-primary fs-base">手配書</span>
            </div>
        </div>
        <div class="d-flex align-items-center position-relative ps-md-3 pe-lg-5 mb-2">
            <div class="ps-3">
                <h6 class="mb-1">作成者</h6>
                <a href="#" class="fw-semibold stretched-link"><%= @post.user.username %></a>
            </div>
        </div>
    </div>
</section>


<!-- Post image (parallax) -->

<div class="jarallax d-flex justify-content-center align-items-center">
  <%= image_tag @post.generated_card.url %>
</div>

<!-- Post content + Sharing -->
<section class="container mb-5 pt-4 pb-2 py-mg-4">
    <div class="row gy-4">

    <!-- Sharing -->
        <div class="col-lg-3 position-relative">
            <div class="sticky-top ms-xl-5 ms-lg-4 ps-xxl-4" style="top: 105px !important;">
                <span class="d-block mb-3"><%= @post.created_at.strftime('%Y年%m月%d日 %H:%M') %></span>
                <h6>Share this post:</h6>
                <div class="mb-4 pb-lg-3">
                <a href="#" class="btn btn-icon btn-secondary btn-twitter me-2 mb-2">
                    <i class="bi bi-twitter"></i>
                </a>
                </div>
                    <% if current_user && current_user.own?(@post) %>
                        <button class="btn btn-lg btn-outline-secondary">
                        <%= link_to '削除', post_path(@post), data: { turbo_method: :delete, turbo_confirm: "削除しますか?" } %>
                        </button>
                    <% end %>
            </div>
        </div>
    </div>
</section>

<!-- Post comments -->
<section class="container mb-4 pt-lg-4 pb-lg-3">
    <h2 class="h1 text-center text-sm-start">4 comments</h2>
    <div class="row">
        <!-- Comments -->
        <div class="col-lg-9">
        <!-- Comment -->
            <% @messages.each do |message| %>
                <div class="py-4">
                    <div class="d-flex align-items-center justify-content-between pb-2 mb-1">
                        <div class="d-flex align-items-center me-3">
                            <div class="ps-3">
                            <h6 class="fw-semibold mb-0"><%= message.user.username %></h6>
                            <span class="fs-sm text-muted">4 mins ago</span>
                            </div>
                        </div>
                        <a href="#" class="nav-link fs-sm px-0">
                        <i class="bx bx-share fs-lg me-2"></i>
                        Reply
                    </a>
                    </div>
                    <p class="mb-0"><%= message.content %></p>
                </div>
            <% end %>
            <hr class="my-2">
        </div>
    </div>
</section>


<!-- Comment form + Subscription -->
<section class="container mb-4 pb-2 mb-md-5 pb-lg-5">
<div class="row gy-5">

<h1>Chat room</h1>
<div data-post-id="<%= @post.id %>" id="messages">
    <%= render partial: 'messages/message', locals: { messages: @messages } %>
</div>

    <!-- Comment form -->
    <div class="col-lg-9">
        <div class="card p-md-5 p-4 border-0 bg-secondary">
            <div class="card-body w-100 mx-auto px-0" style="max-width: 746px;">
                <h2 class="mb-4 pb-3">Leave a Comment</h2>
                <form class="row gy-4 needs-validation" novalidate>
                    <div class="col-12">
                        <label for="c-comment" class="form-label fs-base">Comment</label>
                        <textarea data-behavior="post_speaker" id="post_input" class="form-control form-control-lg" rows="3" placeholder="Type your comment here..." required></textarea>
                        <span class="invalid-tooltip">Please, enter your comment.</span>
                    </div>
                    <div class="col-12">
                        <button id="submit_button" type="submit" class="btn btn-lg btn-primary w-sm-auto w-100 mt-2">Post comment</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
